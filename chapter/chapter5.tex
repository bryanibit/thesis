\chapter{实验结果分析}

\section{引言}
本文简述基于全景图像的二维地图构建与基于航拍图像的三维地图构建方法，构建适用于无人驾驶的地图，并对地图中的道路进行提取，构建拓扑路网。本章将从实验结果分析算法的有效性，实验分为三部分，二维、三维地图构建，道路提取，由于实验平台不同，将在各节文章中单独介绍。实验将分析构图或道路提取的精度，并简单介绍实验结果如何应用于无人驾驶中。
\section{全景图像构建地图实验结果}
\subsection{全景图像地图实验平台搭建}
\subsection{全景图像地图构建效果及精度分析}

\section{地理空间三维重建实验结果}
\subsection{地理空间三维重建实验平台搭建}
\subsubsection{计算平台}
\begin{figure}[!htbp]
	\centering
    \includegraphics[width=4.0in]{chapter5/reconstruction/experiment.png}
    \label{m100}
    \caption{DJI M100}
\end{figure}

本文是用算法由C++/Python实现，SfM与MVS实现是基于Opencv、CeresSolver开源库，本研究使用运行Ubuntu 14.04 LTS操作系统的台式机，台式机CPU型号为intel酷睿i5-4570，CPU主频为3.2GHz，并配置8GB单通道内存，没有配置独立显卡。航拍图像采集工具为大疆（DJI）M100无人机，如图~\ref{m100}所示，图像分辨率为$4000\times 2240$，直接存储于无人机相机的16GB SD卡中，用于本文实验后处理。
\subsubsection{三维重建精度}
\begin{figure}[!htbp]
	\centering
	\subfigure[稀疏点云]{
		\label{fig:sparse} %% label for first subfigure
		\includegraphics[width=2.5in]{chapter5/reconstruction/sparse_perspect.png}}
	\subfigure[稠密点云]{
		\label{fig:dense} %% label for first subfigure
		\includegraphics[width=2.5in]{chapter5/reconstruction/dense_perspect.png}}
	\caption{实验结果-雾岚}
	\label{fig:wulan} %% label for entire figure
\end{figure}

如图~\ref{fig:wulan}所示，使用$54$张DJI航拍图像得到的稀疏点云（图~\ref{fig:sparse}）与稠密点云（图~\ref{fig:dense}），稀疏点云显示在RVIZ软件中，其中每个点都是提取的SIFT2D特征点还原的3D点，稠密点云是使用基于深度图融合的方法得到并显示在Meshlab中。为了更好的衡量构图的精度，本文根据Turner\cite{Turner-Automated}测量构图精度的方法，同样采用设置地面控制点的方式，如图~\ref{example-gcp-image}所示，其中红色圆圈标记的白色纸张为设置的标记点。设置地面控制点的操作就是在构图区域使用高精度卫星定位系统测试真实场景某点（白色纸张的中心）的经纬度坐标，而后标记该场景所成二维图像中对应点的像素坐标（白纸中心成像对应的像素坐标），如表~\ref{table:gcp} 所示。从而在构建三维地图的同时，根据已知标注点的绝对地理位置坐标与其像素坐标得到整个三维模型的地理空间尺度，可以直接作为GIS 数据库的输入数据，形成可以使用的地图信息。

\begin{figure}[htbp]
\centering
\includegraphics[width=4.0in]{chapter5/reconstruction/DJI_0104.JPG}
\label{example-gcp-image}
\end{figure}

\begin{table}[!htbp]
	\caption{地面控制点坐标}
	\centering
	\begin{tabular}{c|cccc}
		\hline
		\diagbox[dir=SE]{\bfseries 图片名称}{\bfseries 坐标名称} & \bfseries 东向 & \bfseries 北向 & \bfseries 图像X方向 & \bfseries 图像Y方向\\
		\hline

		\bfseries DJI\_0050.JPG &  $415462.60$ &  $4401226.15$ & $2706$ & $1615$\\

		\bfseries DJI\_0054.JPG & $415462.60$ & $4401226.15$ & $1312$ & $438$\\

        \bfseries DJI\_0052.JPG & $415462.60$ & $4401226.15$ & $2355$ & $440$\\

        \bfseries DJI\_0077.JPG & $415489.00$ & $4401201.80$ & $1011$ & $1033$\\

        \bfseries $\cdots\cdots$ & $\cdots\cdots$ & $\cdots\cdots$ & $\cdots\cdots$\\
		\hline
	\end{tabular}
	\label{table:gcp}
\end{table}

本文在图~\ref{fig:wulan}场景中设置了9个地面控制点，最后根据成像模型测得这9个点的坐标与实际使用RTK GPS接收机的结果对比如表~\ref{table:gcp_error}所示，每个测试点的精度分为东向与北向，二者的平方根表示在表最后一列为绝对误差，最后计算9个控制点的平均绝对误差为$1.586m$，由于地面控制点分布较均匀，地图某些局部变形较大，导致平均误差较大。

\begin{table}[!htbp]
	\caption{地面控制点误差测量}
	\centering
	\begin{tabular}{cccc}
		\hline
		\bfseries 控制点序号 & \bfseries 东向误差 & \bfseries 北向误差 & \bfseries 绝对误差\\
		\hline
%		\hline
		\bfseries 0 &  $0.093$ &  $0.095$ & $0.132$ \\
		\bfseries 1 & $0.267$ & $0.012$ & $0.268$ \\
        \bfseries 2 & $1.353$ & $2.165$ & $2.553$\\
        \bfseries 3 & $0.879$ & $1.888$ & $2.081$ \\
         \bfseries 4 & $0.260$ & $0.013$ & $0.261$ \\
        \bfseries 5 & $0.195$ & $1.542$ & $1.554$ \\
        \bfseries 6 & $2.148$ & $3.73$ & $4.311$ \\
        \bfseries 7 & $0.184$ & $0.207$ & $0.276$ \\
         \bfseries 8 & $1.298$ & $2.521$ & $2.8355$ \\
		\hline
	\end{tabular}
	\label{table:gcp_error}
\end{table}





\begin{figure}[!htbp]
	\centering
	\subfigure[稀疏点云]{
		\label{fig:sparse1} %% label for first subfigure
		\includegraphics[width=2.5in]{chapter5/reconstruction/dense_perspect1.png}}
	\subfigure[稠密点云]{
		\label{fig:dense1} %% label for first subfigure
		\includegraphics[width=2.5in]{chapter5/reconstruction/dense_perspect1.png}}
	\caption{实验结果-自动化学院}
	\label{fig:6building} %% label for entire figure
\end{figure}


\subsection{三维重建效果及精度分析}

\section{道路提取精度分析}

\begin{figure*}[!htbp]
	\centering
	\subfigure[RGB拟合]{
		\label{fig:subfig:RGB} %% label for first subfigure
		\includegraphics[width=1.14in]{chapter5/extraction/RGBOriginal.jpg}}
	\subfigure[开闭运算]{
		\label{fig:subfig:open} %% label for first subfigure
		\includegraphics[width=1.14in]{chapter5/extraction/openoperation.jpg}}
	%%\hspace{1in}
	\subfigure[非道路区域移除]{
		\label{fig:subfig:RemoveHouse} %% label for second subfigure
		\includegraphics[width=1.14in]{chapter5/extraction/removehouse.jpg}}
	\subfigure[拓扑细化]{
		\label{fig:subfig:first} %% label for first subfigure
		\includegraphics[width=1.14in]{chapter5/extraction/firstmiddlecenter.jpg}}
	\subfigure[实验拓扑]{
		\label{fig:subfig:finalroad} %% label for first subfigure
		\includegraphics[width=1.14in]{chapter5/extraction/finalmiddlecenter.jpg}}
	\caption{道路提取过程}
	\label{fig:subfig_results} %% label for entire figure
\end{figure*}

根据第四章道路提取的原理，本节设计实验验证道路提取方法的精度。图~\ref{resultSift}是用来提取道路的二维地图，由于单张航拍二维图片表示的道路区域无法形成拓扑网络，所以从单张航拍图片中提取道路，而后根据航拍原图间的单应性关系拼接得到如图~\ref{resultSift}（原图拼接结果）和~\ref{fig:subfig:RGB}（单张图片RGB拟合结果），而后应用本文提出的道路提取方法精细道路区域，拓扑细化得到最后的实验结果。整个过程如图~\ref{fig:subfig_result}所示，其中图~\ref{fig:subfig:open}表示开闭运算平滑后的结果，图~\ref{fig:subfig:RemoveHouse}为移除矩形非道路区域后的结果，从中可以看出图左下方的房屋边沿被移除，图~\ref{fig:subfig:first}为采用RDP算法进行拓扑细化后的结果，可以看出初始拓扑有很多小枝丫，使用逐渐递减的阈值去除小枝丫后如图~\ref{fig:subfig:finalroad}所示。

\begin{figure*}[!htbp]
    \centering
    \subfigure[二维地图]{
    \label{resultSift}
    \includegraphics[width=1.9in]{chapter5/extraction/result_SIFT.jpg}}
    \subfigure[实验拓扑]{
		\label{fig:subfig:finalroad} %% label for first subfigure
		\includegraphics[width=1.75in]{chapter5/extraction/finalmiddlecenter.jpg}}
    \subfigure[真值拓扑]{
		\label{fig:subfig:real} %% label for first subfigure
		\includegraphics[width=1.75in]{chapter5/extraction/manual_real_road.jpg}}
%    \subfigure{
%    \includegraphics[width=2.8in]{chapter5/extraction/result_chart.png}}

    \caption{道路提取对比}
\end{figure*}

使用道路提取的方法得到道路拓扑网络后，图~\ref{resultSift}分别展示了原图，提取道路（图~\ref{fig:subfig:finalroad}）与真实道路（图~\ref{fig:subfig:real}），两幅图中道路拓扑是由单像素构成，通过膨胀真实道路，计算提取道路的像素不在膨胀后的真实道路区域的比例，绘制图~\ref{curve}，其中横轴代表膨胀时使用的核函数的大小，单位是像素，而且一个像素大约代表地理空间16$cm$，核函数越大，膨胀后的真实道路区域越大，不在其区域的提取道路的像素越少。从图中可以看出核函数大小为$10$个像素，即$1.6m$时，有接近$90\%$提取的道路在膨胀区域内，也就是$90\%$的道路误差小于$1.6m$，同时可以看出$80\%$ 的道路误差小于$1m$。

\begin{figure}[!htbp]
\centering
\includegraphics[width=2.8in]{chapter5/extraction/result_chart.png}
\caption{道路提取精度曲线}
\label{curve}
\end{figure}

\section{本章小结}

\newpage
\mbox{}
\newpage
